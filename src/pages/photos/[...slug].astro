---
import { getCollection } from "astro:content";
// 1. Change this import
import PhotoAlbumLayout from "../../layouts/PhotoAlbumLayout.astro";

export async function getStaticPaths() {
  const photos = await getCollection("photos");
  
  return photos
    .filter(p => p.data.type === "internal")
    .map((p) => {
      // Handles potential subfolder slugs
      const cleanSlug = p.slug.split('/')[0];

      return {
        params: { slug: cleanSlug },
        props: { photoEntry: p },
      };
    });
}

const { photoEntry } = Astro.props;
const { Content } = await photoEntry.render();
---

{/* 2. Swap <Layout> for <PhotoAlbumLayout> */}
<PhotoAlbumLayout frontmatter={photoEntry.data}>
    <Content />
</PhotoAlbumLayout>